# <span style="color:lime">LINE Developers</span>のBotを使ったリマインドBot
## できること
1. 予定を登録
2. 予定を削除
3. 登録されている予定を期間を決めて確認
4. 日付を指定して予定を確認
5. 曜日ごとの時間割を確認
6. あらかじめ決まっている日付のフォーマットと曜日を変換
---
## 全体を通して共通すること
- 日付のフォーマットは`yyyyMMdd`の形。 ( 20230416 )
- 日付は曜日1文字でも可能。 (20230412 = 水(曜日))
- コマンドキーは大文字と小文字を問わない。
- LINE Botを使うため、<span style="color:lime">LINE Developersアカウント</span>を1つ持っておく必要がある。
- 予定のデータベースにGoogleスプレッドシートを使うため、<span style="color:#3aa9ff">Googleアカウント</span>を1つ持っておく必要がある。
---
## 1.予定を登録
```
r
登録する予定の日付
登録したい予定の名称
```
スプレッドシートに
||A|B|
|:---:|:---:|:---:|
|1|日付|予定の名称|
||||

として記録される。<br>

---
## 2.予定を削除
```
n
削除する予定の日付
削除したい予定の名称
```
スプレッドシートの
||A|B|
|:---:|:---:|:---:|
|1|日付|予定の名称|
||||

の列が削除される。<br>

---
## 3.登録されている予定を期間を決めて確認
```
c
```
登録されている予定のうち、当日を含む7日分の予定が返信する。<br><br>
```
c
日付
```
当日から指定日までの予定をすべて返信する。(処理が長くなるので30日以内に制限)<br>

---
## 4.日付を指定して予定を確認
```
s
日付
```
指定日のみの予定を返信する。<br>

---
## 5.曜日ごとの時間割を確認
```
t
```
0時から15時は当日、15時から0時は翌日の時間割と予定を返信する。<br><br>
```
t
日付
```
指定日の時間割と予定を返信する。<br>

---
## 6.あらかじめ決まっている日付のフォーマットと曜日を変換
```
e
日付
```
`yyyyMMdd` (20230416) の日付を送ると対応する曜日を返信する。<br>曜日1文字を送ると1週間以内の対応する日付を返信する。

---
# Botを作る
## LINE Developers
[LINE Developers Messaging API](https://developers.line.biz/ja/services/messaging-api/)にアクセスする。<br><br>
今すぐはじめようを押す。<br>
名前とメールアドレスを入力してアカウント作成する。<br>
チャネルの各種設定をする。
- チャネルの種類 → Messaging API
- プロバイダー → 新規プロバイダー作成
- プロバイダー名 → わかりやすいもの
- 所在地・地域 → 住んでいる場所
- アイコン、チャネル名 → トークルームで表示されるもの
- チャネル名 → わかりやすいもの
- チャネル説明 → Botの詳細
- 大業種 → 個人
- 小業種 → あてはまるもの
- メールアドレス → メインで使っているもの

規約を読んで同意する ×2<br>
作成を押す<br><br>
作成できたら
- QRコードから友だちになっておく
- <span style="color:yellow">Messaging API設定</span>の下部にある「チャネルアクセストークン(長期)」を発行してコピーする。<br><br>
## Google Spreadsheet
[Googleスプレッドシート](https://docs.google.com/spreadsheets/)にアクセスする。<br>
空白で新しいシートを作成する。<br>
上部にあるツールバーの拡張機能からApps Scriptに進む。<br>
すでに書かれているコードを削除してからGithubリポジトリ内のCode.gsをコピペする。<br><br>
## Google Apps Script
3~26行目の `''`で囲まれた中をそれぞれ入力する。<br>
- 4行目 コピーした「チャネルアクセストークン(長期)」を貼り付ける。
- 6行目 スプレッドシートの`https://docs.google.com/spreadsheets/d/ この部分 /edit#gid=0`を貼り付ける。
- 8行目 スプレッドシートの名前(画面下部に表示)を入力する。<br>

321~346行目のコマンドキーを変えることで自由にコマンドを呼び出せる。<br><br>

画面右上のデプロイから新しいデプロイを選択。<br>
種類の選択からウェブアプリを選択<br>
- 新しい説明文 → わかりやすい文章
- アクセスできるユーザー → 全員

デプロイを押す。<br>
ウェブアプリのURLをコピーして、LINE Developersの<span style="color:yellow">Messaging API設定</span>内のWebhook URLに貼り付ける。<br><br>
正しく出来ていればBotに正しいコマンドを送ると返信される。<br><br>

## 関係のないメッセージが同時に返信される場合
LINE Developersの<span style="color:yellow">Messaging API設定</span>から応答メッセージとあいさつメッセージを無効にする。<br><br>
# License
The source code is licensed MIT. The website content is licensed CC BY 4.0,see LICENSE.<br>

---
<br>

###### 初めてMarkdown書いた
